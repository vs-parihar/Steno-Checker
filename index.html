<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <title>Steno Player</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<div id="app">
    <div class="card">
        <div class="tb-row">
            <div style="display:flex;gap:2px">
                <button onclick="$('f').click()" style="padding:0 8px">üìÅ</button>
                <button onclick="openM()" id="libBtn" style="padding:0 8px">üåê</button>
                <button onclick="opTr()" style="padding:0 8px;border-color:var(--sk)">‚å®Ô∏è Tr</button>
                <button onclick="$('exM').classList.add('active')" style="padding:0 8px;border-color:var(--ye)">üìù Exam</button>
            </div>
            <div style="flex:1"></div>
            <div style="display:flex;gap:2px">
                <button onclick="expA()" id="exB" style="width:24px">‚¨áÔ∏è</button>
            </div>
        </div>
        <input type="file" id="f" hidden multiple>
        <div class="row" style="align-items:flex-end">
            <div style="width:70px">
                <label class="lbl">Words</label>
                <div style="display:flex">
                    <input type="number" id="wc" value="0" style="width:100%" readonly>
                    <select id="wcM" onchange="upWC()" style="width:15px;padding:0">
                        <option value="0">Sp</option>
                        <option value="1">St</option>
                        <option value="2">Pn</option>
                    </select>
                </div>
            </div>
            <div style="flex:1">
                <div class="tb-row" style="margin:0">
                    <label class="lbl">Display</label>
                    <div style="flex:1"></div>
                    <div class="ctrl-grp">
                        <label style="display:flex;gap:2px;font-size:9px;align-items:center;cursor:pointer">
                            <input type="checkbox" class="th-chk" onchange="tTh()" style="height:12px;margin:0">L
                        </label>
                        <div class="sep"></div>
                        <button class="xs-btn" onclick="adj('ts',-1)">T-</button>
                        <button class="xs-btn" onclick="adj('ts',1)">T+</button>
                        <button class="xs-btn" onclick="adj('sc',-0.05)">S-</button>
                        <button class="xs-btn" onclick="adj('sc',0.05)">S+</button>
                    </div>
                </div>
                <div class="row" style="margin:0;align-items:center">
                    <button class="sm-btn" onclick="$('vl').value=1;upV()">R</button>
                    <input type="range" id="vl" min="0" max="2" step="0.1" value="1" style="flex:1;height:24px" oninput="upV()">
                </div>
            </div>
        </div>
    </div>

    <div class="status-bar">
        <div class="ticker"><span id="stTitle">No Audio Loaded</span></div>
        <div class="stat-item" id="stWPM">0 WPM</div>
        <div class="stat-item" id="stRate">1.0x</div>
        <div class="stat-item" id="stWC">0 W</div>
    </div>

    <textarea id="tx" class="card" placeholder="Content..." oninput="upWC()"></textarea>

    <div class="card" style="margin-top:auto">
        <div class="row" style="justify-content:space-between;align-items:center">
            <div style="display:flex;gap:8px;align-items:center">
                <label class="chk-row" style="display:flex;align-items:center;gap:2px;font-size:11px"><input type="checkbox" id="as" checked>Scroll</label>
                <label class="chk-row" style="display:flex;align-items:center;gap:2px;font-size:11px"><input type="checkbox" id="bp" checked>Beep</label>
            </div>
            <span id="st" style="font-size:11px">Ready</span>
        </div>
        <audio id="au" crossorigin="anonymous" preload="auto" style="display:none"></audio>
        <div class="row" style="align-items:center">
            <button id="pl"><svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg></button>
            <button id="sb"><svg viewBox="0 0 24 24"><path d="M6 6h12v12H6z"/></svg></button>
            <div class="p-box" id="pb"><div class="p-fill" id="pf"></div></div>
            <span id="tm" style="font-family:monospace;margin-left:2px;white-space:nowrap;font-size:11px">0:00/0:00</span>
        </div>
        <div class="row" style="justify-content:center;gap:6px">
            <button onclick="stepTrk(-1)" style="width:40px">‚èÆ</button>
            <button onclick="sk(-10)" style="width:40px;color:var(--ye)">-10</button>
            <button onclick="sk(-5)" style="width:40px;color:var(--ye)">-5</button>
            <button onclick="sk(5)" style="width:40px;color:var(--re)">+5</button>
            <button onclick="sk(10)" style="width:40px;color:var(--re)">+10</button>
            <button onclick="stepTrk(1)" style="width:40px">‚è≠</button>
        </div>
        <div class="row" style="align-items:center;justify-content:flex-start" id="spdCtrls">
            <div style="display:flex;align-items:flex-end;gap:4px">
                <div>
                    <label class="lbl">WPM</label>
                    <div class="row" style="margin:0;gap:1px">
                        <button class="sm-btn" onclick="adW(-1)">-</button>
                        <input type="text" id="wi" style="width:70px;height:28px">
                        <select id="ws" class="drop-thin" onchange="dS('w',this.value);sync('w')"><option value="">‚ñº</option></select>
                        <button class="sm-btn" onclick="adW(1)">+</button>
                    </div>
                </div>
                <div class="sep"></div>
                <div>
                    <label class="lbl">Rate</label>
                    <div class="row" style="margin:0;gap:1px">
                        <button class="sm-btn" onclick="adR(-0.0001)">-</button>
                        <input type="number" id="ri" value="1.0000" style="width:70px;height:28px">
                        <select id="rs" class="drop-thin" onchange="dS('r',this.value);sync('r')"><option value="">‚ñº</option></select>
                        <button class="sm-btn" onclick="adR(0.0001)">+</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="md" class="modal">
    <div class="modal-inner">
        <div class="row"><select id="rg" style="width:100px"><option value="">All</option></select><input type="text" placeholder="Search..." oninput="renL()" id="libS" style="flex:1"><select id="srt" style="width:60px" onchange="renL()"><option value="on">O-N</option><option value="no">N-O</option><option value="az">A-Z</option></select><button onclick="openM()" class="cls-btn">‚úï</button></div>
        <div class="row" style="justify-content:center;background:var(--inp-bg);padding:2px" id="mdC"></div>
        <div class="range-wrap">
            <select id="preW" onchange="setP(this.value)" style="height:24px;font-size:10px"><option value="0-max">Any</option><option value="0-200">0-200</option><option value="200-500">200-500</option></select>
            <input type="number" id="wMin" value="0" style="width:35px;height:24px;font-size:10px" oninput="uSl('min',this.value)">
            <div class="sl-con"><input type="range" id="slMi" min="0" max="1" value="0" oninput="uSl('min',this.value)"><input type="range" id="slMa" min="0" max="1" value="1" oninput="uSl('max',this.value)"></div>
            <input type="number" id="wMax" value="0" style="width:45px;height:24px;font-size:10px" oninput="uSl('max',this.value)">
        </div>
        <div id="tags" style="overflow-x:auto;white-space:nowrap;padding:1px 0"></div>
        <div id="ls" style="overflow-y:auto;flex:1;padding-top:2px;border-top:1px solid var(--bd)"></div>
    </div>
</div>

<div id="exM" class="modal">
    <div class="modal-inner" style="height:auto;max-height:90vh">
        <div class="row" style="border-bottom:1px solid var(--bd);padding:4px"><b>Exam Setup</b><button onclick="$('exM').classList.remove('active')" class="cls-btn" style="margin-left:auto">‚úï</button></div>
        <div style="padding:8px;overflow-y:auto">
            <div class="row"><label>Mode</label><select id="exMode" style="flex:1"><option value="prac">Practice (Unlocked)</option><option value="mock">Mock (Locked)</option></select></div>
            <div class="row"><label>Preset</label><select id="exP" onchange="ldEx(this.value)"><option value="def">Default</option><option value="ssc_c_eng">SSC C (Eng)</option><option value="ssc_c_hin">SSC C (Hin)</option><option value="ssc_d_eng">SSC D (Eng)</option><option value="ssc_d_hin">SSC D (Hin)</option><option value="hc">High Court</option><option value="cus">Custom</option></select></div>
            <div class="row"><div style="flex:1"><label class="lbl">Time (m)</label><input type="number" id="exT" value="10"></div><div style="flex:1"><label class="lbl">WPM</label><input type="number" id="exW" value="80"></div></div>
            <div style="margin-top:8px;font-weight:bold;font-size:11px">Error Weights</div>
            <div id="exC" class="err-grid"></div>
        </div>
        <div class="row" style="padding:8px;border-top:1px solid var(--bd)"><button onclick="svEx(1)" style="flex:1;border-color:var(--gr)">Load Audio</button><button onclick="svEx(0)" style="flex:1;border-color:var(--ye)">Open Offline</button></div>
    </div>
</div>

<div id="trM" class="modal">
    <div class="modal-inner" style="height:90%;margin-top:auto;margin-bottom:auto">
        <div class="row" style="background:var(--inp-bg);padding:2px;border-bottom:1px solid var(--bd);justify-content:space-between">
            <div style="display:flex;align-items:center;gap:4px;flex:1">
                <select id="tmD" onchange="sTm(this.value)" style="width:70px"><option value="0">‚àû</option><option value="1">1m</option><option value="2">2m</option><option value="5">5m</option><option value="10">10m</option><option value="15">15m</option><option value="30">30m</option><option value="-1">Cus</option></select>
                <input id="tmC" type="number" style="width:40px;display:none" onblur="sTm(this.value)"><span id="tmR" style="font-family:monospace;font-weight:bold;margin-left:4px" class="tm-gr">00:00</span>
            </div>
            <div id="trC" class="ctrl-grp"></div>
            <button onclick="$('trM').classList.remove('active')" class="cls-btn">‚úï</button>
        </div>
        <div id="trV" style="display:flex;flex-direction:column;flex:1;overflow:hidden">
            <textarea id="trI" placeholder="Type here..." style="margin:4px 0;border:none;flex:1;font-size:var(--ts);max-height:60vh" oninput="stTmr()"></textarea>
            <div class="row" style="background:var(--inp-bg);padding:4px;border-top:1px solid var(--bd);align-items:center"><button onclick="check()" style="flex:1;border-color:var(--gr);height:36px;font-weight:bold">Check / Submit</button></div>
        </div>
        <div id="rsV" style="display:none;flex-direction:column;flex:1;overflow:hidden">
            <div id="resBox"><div id="resDet" class="stats"></div></div>
            <div id="rS" class="res-view"></div>
            <div id="erL" class="err-list"></div>
            <div class="row" style="padding:2px"><button class="norm-btn" id="nb" onclick="tN()">Norm View</button></div>
        </div>
    </div>
</div>

<script src="js/audio-config.js"></script>
<script src="js/exam-config.js"></script>
<script src="js/processor.js"></script>
<script src="js/audio-engine.js"></script>
<script src="js/mock-engine.js"></script>
<script src="js/checker.js"></script>
<script src="js/result.js"></script>
<script src="js/ui-controller.js"></script>
</body>
</html>