const nm=s=>s.replace(/[०-९]/g,d=>d.charCodeAt(0)-2406).replace(/[\u095c\u095d]/g,c=>c=='\u095c'?'\u0921\u093c':'\u0922\u093c').replace(/\u093c/g,'').normalize("NFC");
const nz=s=>nm(s).replace(/[\u0902\u0901]/g,'ŋ').replace(/[\u092e\u0928]\u094d/g,'ŋ').replace(/\u090f/g,'\u092f\u0947').replace(/\u0907/g,'\u092f\u093f').replace(/\u093e\u090f/g,'\u093e\u092f\u0947').replace(/\u093e\u0907/g,'\u093e\u092f\u093f');
const ny=s=>nm(s).replace(/ये/g,'ए').replace(/यी/g,'ई').replace(/यें/g,'एं').replace(/ए/g,'ये').replace(/ई/g,'यी').replace(/एं/g,'यें');
const np=s=>nm(s).replace(/[ंँ]/g,'');
const isM=c=>/[\u093e-\u094d\u0951-\u0954\u0962\u0963\u0901-\u0903]/.test(c);
const tok=s=>{let r=[],curr='',l=s.length;for(let i=0;i<l;i++){let c=s[i];if(isM(c))curr+=c;else{if(curr)r.push(curr);curr=c}}if(curr)r.push(curr);return r};
const cln=s=>s.replace(/[\u2018\u2019]/g,"'").replace(/[\u201C\u201D]/g,'"').replace(/I've/g,"I have").replace(/don't/g,"do not").replace(/can't/g,"cannot").replace(/it's/g,"it is");
const splitT=t=>cln(t).replace(/([\d०-९]+)([\.\?])([\d०-९]+)/g,(m,a,s,b)=>a+(s==='.'?'\uE001':'\uE002')+b).replace(/([\.?!,;:\-\(\)\[\]"'।])/g,' $1 ').replace(/([\d०-९\uE001\uE002]+)/g,' $1 ').replace(/\uE001/g,'.').replace(/\uE002/g,'?').split(/\s+/).filter(x=>x).map(v=>({v,t:v.match(/^[\.?!,;:\-\(\)\[\]"'।]+$/)?'p':'w'}));
const wSc=s=>tok(s).reduce((a,c)=>a+((c.match(/[\u0915-\u0939\u0958-\u095F\w]/))?2:1),0)||1;
const uDiff=(a,b)=>{const ac=a[0],bc=b[0],am=a.substring(1),bm=b.substring(1);if(ac!==bc)return 1;return am!==bm?0.5:0};
const wLv=(s,t)=>{let S=tok(s),T=tok(t),n=S.length,m=T.length,d=Array.from({length:n+1},()=>Array(m+1).fill(0));for(let i=1;i<=n;i++)d[i][0]=d[i-1][0]+(S[i-1].match(/[\u0915-\u0939\u0958-\u095F\w]/)?2:1);for(let j=1;j<=m;j++)d[0][j]=d[0][j-1]+(T[j-1].match(/[\u0915-\u0939\u0958-\u095F\w]/)?2:1);for(let i=1;i<=n;i++)for(let j=1;j<=m;j++){let c=uDiff(S[i-1],T[j-1]),sz=(S[i-1].match(/[\u0915-\u0939\u0958-\u095F\w]/)?2:1);d[i][j]=Math.min(d[i-1][j]+sz,d[i][j-1]+sz,d[i-1][j-1]+(c===0?0:(c===0.5?0.5:2)))}return d[n][m]};
const lv=(a,b)=>{let S=tok(a),T=tok(b),d=Array.from({length:S.length+1},(_,i)=>[i]);for(let j=1;j<=T.length;j++)d[0][j]=j;for(let i=1;i<=S.length;i++)for(let j=1;j<=T.length;j++)d[i][j]=S[i-1]===T[j-1]?d[i-1][j-1]:Math.min(d[i-1][j],d[i][j-1],d[i-1][j-1])+1;return d[S.length][T.length]};
const getChD=(s,t)=>{const S=Array.from(s),T=Array.from(t),m=S.length,n=T.length,d=Array.from({length:m+1},()=>Array(n+1).fill(0));for(let i=0;i<=m;i++)d[i][0]=i;for(let j=0;j<=n;j++)d[0][j]=j;for(let i=1;i<=m;i++)for(let j=1;j<=n;j++)d[i][j]=Math.min(d[i-1][j]+1,d[i][j-1]+1,d[i-1][j-1]+(S[i-1]===T[j-1]?0:1));let i=m,j=n,ops=[];while(i>0||j>0){if(i>0&&j>0&&S[i-1]===T[j-1]){i--;j--}else if(i>0&&j>0&&d[i][j]===d[i-1][j-1]+1){ops.push(`SP:${T[j-1]} instead ${S[i-1]}`);i--;j--}else if(j>0&&d[i][j]===d[i][j-1]+1){ops.push(`SP:+${T[j-1]}`);j--}else{ops.push(`SP:-${S[i-1]}`);i--}}return ops.reverse()}
const eq=(a,b)=>nz(a)===nz(b);
const cNum=s=>s.match(/^[\d,]+$/)?s.replace(/,/g,''):s;
function fT(s){const m=Math.floor(s/60),x=Math.floor(s%60);return`${m}:${x<10?'0':''}${x}`}