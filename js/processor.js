const nm=s=>s.replace(/[०-९]/g,d=>d.charCodeAt(0)-2406).replace(/[\u095c\u095d]/g,c=>c=='\u095c'?'\u0921\u093c':'\u0922\u093c').replace(/\u093c/g,'').normalize("NFC");
const nz=s=>nm(s).replace(/[\u0902\u0901]/g,'ŋ').replace(/[\u092e\u0928]\u094d/g,'ŋ').replace(/\u090f/g,'\u092f\u0947').replace(/\u0907/g,'\u092f\u093f').replace(/\u093e\u090f/g,'\u093e\u092f\u0947').replace(/\u093e\u0907/g,'\u093e\u092f\u093f');
const ny=s=>nm(s).replace(/ये/g,'ए').replace(/यी/g,'ई').replace(/यें/g,'एं').replace(/ए/g,'ये').replace(/ई/g,'यी').replace(/एं/g,'यें');
const np=s=>nm(s).replace(/[ंँ]/g,'');
const isM=c=>/[\u093e-\u094d\u0951-\u0954\u0962\u0963\u0901-\u0903]/.test(c);
const tok=s=>{let r=[],curr='',l=s.length;for(let i=0;i<l;i++){let c=s[i];if(isM(c))curr+=c;else{if(curr)r.push(curr);curr=c}}if(curr)r.push(curr);return r};
const cln=s=>s.replace(/[\u2018\u2019]/g,"'").replace(/[\u201C\u201D]/g,'"').replace(/I've/g,"I have").replace(/don't/g,"do not").replace(/can't/g,"cannot").replace(/it's/g,"it is");
const splitT=t=>cln(t).replace(/([\d०-९]+)([\.\?])([\d०-९]+)/g,(m,a,s,b)=>a+(s==='.'?'\uE001':'\uE002')+b).replace(/([\.?!,;:\-\(\)\[\]"'।])/g,' $1 ').replace(/([\d०-९\uE001\uE002]+)/g,' $1 ').replace(/\uE001/g,'.').replace(/\uE002/g,'?').split(/\s+/).filter(x=>x).map(v=>({v,t:v.match(/^[\.?!,;:\-\(\)\[\]"'।]+$/)?'p':'w'}));
const parseU=t=>{let b=t[0],h=t.includes('\u094d'),m=t.match(/[\u093e-\u094c\u0962\u0963]/),n=t.match(/[\u0901\u0902]/);return{b,h,m:m?m[0]:'',n:n?n[0]:''}};
const wSc=s=>tok(s).reduce((a,c)=>{let p=parseU(c);return a+1+(p.m?0.5:0)+(p.n?0.2:0)},0)||1;
const uDiff=(s,t)=>{if(s===t)return 0;let S=parseU(s),T=parseU(t),c=0;if(S.b!==T.b)return 1;if(S.h!==T.h)c+=1;if(S.m!==T.m)c+=0.5;if(S.n!==T.n)c+=0.2;return Math.min(c,1.5)};
const wLv=(s,t)=>{let S=tok(s),T=tok(t),n=S.length,m=T.length,d=Array.from({length:n+1},()=>Array(m+1).fill(0));for(let i=1;i<=n;i++){let p=parseU(S[i-1]);d[i][0]=d[i-1][0]+1+(p.m?0.5:0)+(p.n?0.2:0)}for(let j=1;j<=m;j++){let p=parseU(T[j-1]);d[0][j]=d[0][j-1]+1+(p.m?0.5:0)+(p.n?0.2:0)}for(let i=1;i<=n;i++)for(let j=1;j<=m;j++){let c=uDiff(S[i-1],T[j-1]),sz=1+(parseU(S[i-1]).m?0.5:0);d[i][j]=Math.min(d[i-1][j]+sz,d[i][j-1]+sz,d[i-1][j-1]+c)}return d[n][m]};
const getChD=(s,t)=>{const S=Array.from(s),T=Array.from(t),m=S.length,n=T.length,d=Array.from({length:m+1},()=>Array(n+1).fill(0));for(let i=0;i<=m;i++)d[i][0]=i;for(let j=0;j<=n;j++)d[0][j]=j;for(let i=1;i<=m;i++)for(let j=1;j<=n;j++)d[i][j]=Math.min(d[i-1][j]+1,d[i][j-1]+1,d[i-1][j-1]+(S[i-1]===T[j-1]?0:1));let i=m,j=n,ops=[];while(i>0||j>0){if(i>0&&j>0&&S[i-1]===T[j-1]){i--;j--}else if(i>0&&j>0&&d[i][j]===d[i-1][j-1]+1){ops.push(`SP:${T[j-1]} instead ${S[i-1]}`);i--;j--}else if(j>0&&d[i][j]===d[i][j-1]+1){ops.push(`SP:+${T[j-1]}`);j--}else{ops.push(`SP:-${S[i-1]}`);i--}}return ops.reverse()};
const eq=(a,b)=>nz(a)===nz(b);
const cNum=s=>s.match(/^[\d,]+$/)?s.replace(/,/g,''):s;
const stem=s=>{let n=nm(s);if(n.match(/[\u0901\u0902]$/))return n.slice(0,-1);return n.replace(/(\u094b\u0902|\u0947\u0902|\u093e\u0901|\u093f\u092f\u093e\u0902|\u093f\u092f\u094b\u0902|\u094b|\u0947|\u093e)$/,'')};
function fT(s){const m=Math.floor(s/60),x=Math.floor(s%60);return`${m}:${x<10?'0':''}${x}`}